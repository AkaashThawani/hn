import{a as $,b as q,h as j,i as J,j as W,k as X,l as Y}from"./chunk-ZJFOALCH.js";import{O as Q,Q as U,R as Z,h as N,i as R,j as B,k as K,l as G}from"./chunk-OADQSGKE.js";import{Aa as x,Ba as y,Fa as w,Ka as O,L as g,La as P,Na as F,P as C,Q as D,Z as h,Za as H,_a as S,a as L,b as A,ca as a,db as V,ea as b,ia as p,ja as T,jb as z,ka as l,la as o,ma as r,mb as M,na as d,oa as k,ra as f,sa as c,wa as I,za as m,zb as ee}from"./chunk-XQUNHMAM.js";var ae=[""];function oe(s,n){if(s&1){let e=k();o(0,"span",14),f("click",function(){C(e);let i=c(2).index,_=c();return D(_.scrollToNext(_.data,i))}),m(1,"next"),r()}}function re(s,n){if(s&1){let e=k();o(0,"span",15),f("click",function(){C(e),c();let i=T(1);return D(i.expanded=!i.expanded)}),m(1," [ - ] "),r()}}function se(s,n){if(s&1){let e=k();o(0,"span",16),f("click",function(){C(e),c();let i=T(1);return D(i.expanded=!i.expanded)}),m(1,"[ + ]"),r()}}function le(s,n){if(s&1&&(o(0,"div",17),d(1,"app-comments",18),r()),s&2){let e=c(2).$implicit;a(1),l("data",e.kidsData)}}function me(s,n){if(s&1&&(o(0,"mat-expansion-panel",4,5)(2,"mat-expansion-panel-header")(3,"mat-panel-title")(4,"span",6)(5,"a",7),m(6),r(),o(7,"span"),m(8),r(),p(9,oe,2,0,"span",8),o(10,"span"),p(11,re,2,0,"span",9),p(12,se,2,0,"span",10),r()()()(),o(13,"div",11),d(14,"div",12),r(),p(15,le,2,1,"div",13),r()),s&2){let e=T(1),t=c(),i=t.$implicit,_=t.last,ne=c();a(4),l("id",i.id),a(1),I("routerLink","/user/",i.by,""),a(1),x((i==null?null:i.by)+" "),a(2),y("",ne.getTime(i==null?null:i.time)," | "),a(1),l("ngIf",!_),a(2),l("ngIf",e.expanded==!0),a(1),l("ngIf",e.expanded==!1),a(2),l("innerHTML",i==null?null:i.text,h),a(1),l("ngIf",i==null?null:i.kidsData)}}function pe(s,n){if(s&1&&(o(0,"mat-accordion",2),p(1,me,16,9,"mat-expansion-panel",3),r()),s&2){let e=n.$implicit;a(1),l("ngIf",!e.deleted)}}function de(s,n){s&1&&(o(0,"div"),d(1,"div",19)(2,"div",19),o(3,"div"),d(4,"div",19)(5,"div",19),r(),o(6,"div"),d(7,"div",19)(8,"div",19),r()())}var u=class{constructor(){this.data=[]}ngOnInit(){this.sortCommentsOnTime()}scrollToNext(n,e){if(n[e+1]){var t=document.getElementById(n[e+1].id);t?.scrollIntoView({behavior:"smooth",block:"start"})}else console.log("parent scroll trig"),this.scrollToParentNext(n[e].parent);console.log(n)}scrollToParentNext(n){console.log(n)}sortCommentsOnTime(){this.data.sort(({time:n},{time:e})=>n>e?1:n<e?-1:0)}getTime(n){var e=new Date().getTime(),t=new Date(n*1e3).getTime();return e-t<=36e5?new Date(e-t).getUTCMinutes()+" minutes":new Date(e-t).getUTCHours()+" hours"}},E=u;(()=>{u.\u0275fac=function(e){return new(e||u)}})(),(()=>{u.\u0275cmp=g({type:u,selectors:[["app-comments"]],viewQuery:function(e,t){if(e&1&&P(ae,5),e&2){let i;O(i=F())&&(t.span=i.first)}},inputs:{data:"data"},standalone:!0,features:[w],decls:2,vars:2,consts:[["accordion","",4,"ngFor","ngForOf"],[4,"ngIf"],["accordion",""],["hideToggle","","expanded","true","disabled","true","class","comment",4,"ngIf"],["hideToggle","","expanded","true","disabled","true",1,"comment"],["mep","matExpansionPanel"],[1,"comment-info",3,"id"],[3,"routerLink"],["class","next","matTooltip","Go to next",3,"click",4,"ngIf"],["class","minimize","matTooltip","minimize",3,"click",4,"ngIf"],["class","minimize","matTooltip","expand",3,"click",4,"ngIf"],[1,"comment-body"],[1,"comment-text",3,"innerHTML"],["class","sub-comments",4,"ngIf"],["matTooltip","Go to next",1,"next",3,"click"],["matTooltip","minimize",1,"minimize",3,"click"],["matTooltip","expand",1,"minimize",3,"click"],[1,"sub-comments"],[3,"data"],[1,"skeleton","skeleton-text"]],template:function(e,t){e&1&&(p(0,pe,2,1,"mat-accordion",0),p(1,de,9,0,"div",1)),e&2&&(l("ngForOf",t.data),a(1),l("ngIf",t.data.length==0))},dependencies:[u,V,H,S,Y,X,j,J,W,M],styles:[".comment-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:start;align-items:center;gap:4px}@media screen and (max-width: 900px){.sub-comments[_ngcontent-%COMP%]{margin-left:5px}}.sub-comments[_ngcontent-%COMP%]{margin-left:12px}"]})})();function ce(s,n){if(s&1&&d(0,"div",13),s&2){let e=c();l("innerHTML",e.storyData.text,h)}}var v=class{constructor(n,e){this.activatedRoute=n,this.apiService=e,this.storyId="",this.storyData=[],this.kidsArray=[],this.kidsArrayData=[]}ngOnInit(){this.storyId=this.activatedRoute.snapshot.params.id,this.getStoryData()}getStoryData(){this.apiService.getStoryById(this.storyId).subscribe(n=>{this.storyData=n,this.getKidsData()})}getKidsData(){this.kidsArray=this.storyData.kids,this.kidsArray.forEach(n=>{this.apiService.getCommentById(n).subscribe(e=>{var t=this.getSubKids(e);this.kidsArrayData.push(t)})}),console.log(this.kidsArrayData)}getTime(n){var e=new Date().getTime(),t=new Date(n*1e3).getTime();return e-t<=36e5?new Date(e-t).getUTCMinutes()+" minutes":new Date(e-t).getUTCHours()+" hours"}getSubKids(n){if(n.kids){let e=[];return n.kids.forEach(t=>{this.apiService.getCommentById(t).subscribe(i=>{var _=this.getSubKids(i);e.push(_)})}),A(L({},n),{kidsData:e})}else return n}open(n){window.open(n,"_blank")}},te=v;(()=>{v.\u0275fac=function(e){return new(e||v)(b(z),b(ee))}})(),(()=>{v.\u0275cmp=g({type:v,selectors:[["app-story"]],standalone:!0,features:[w],decls:21,vars:9,consts:[[1,"sticky"],[1,"page"],[1,"story"],["fxLayout","row wrap","fxLayoutAlign","start center",1,"p-15"],["fxFlex","15",1,"m-20"],["fxFlex",""],[1,"story-title","bold"],[3,"innerHTML",4,"ngIf"],[1,"story-url",3,"click"],[1,"story-info"],["mat-flat-button","",1,"text-left",3,"routerLink"],["fxLayout","column nowrap","fxLayoutAlign","start stretch","fxLayoutGap","15px",2,"margin-top","10px"],[3,"data"],[3,"innerHTML"]],template:function(e,t){e&1&&(d(0,"app-heading",0),o(1,"div",1)(2,"mat-card",2)(3,"div",3)(4,"div",4),m(5),r(),o(6,"div",5)(7,"span",6),m(8),r(),p(9,ce,1,1,"div",7),o(10,"div",8),f("click",function(){return t.open(t.storyData==null?null:t.storyData.url)}),m(11),r(),o(12,"div",9)(13,"button",10),m(14),r(),o(15,"div"),m(16),r(),o(17,"div"),m(18),r()()()()(),o(19,"div",11),d(20,"app-comments",12),r()()),e&2&&(a(5),x(t.storyData.score),a(3),x(t.storyData==null?null:t.storyData.title),a(1),l("ngIf",t.storyData==null?null:t.storyData.text),a(2),x(t.storyData==null?null:t.storyData.url),a(2),I("routerLink","/user/",t.storyData==null?null:t.storyData.by,""),a(1),y("",t.storyData==null?null:t.storyData.by," "),a(2),y(" ",t.storyData==null?null:t.storyData.descendants," comments "),a(2),y(" ",t.getTime(t.storyData.time)," "),a(2),l("data",t.kidsArrayData))},dependencies:[Z,M,q,$,S,E,U,Q,G,N,R,K,B],styles:[".textarea[_ngcontent-%COMP%]{resize:none}.bold[_ngcontent-%COMP%]{font-weight:700}.p-15[_ngcontent-%COMP%]{padding:15px}"]})})();export{te as StoryComponent};
