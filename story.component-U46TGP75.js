import{a as K,b as B,h as Q,i as G,j as $,k as q,l as U}from"./chunk-4IIXPB34.js";import{a as j}from"./chunk-OEEYWN56.js";import{Ca as S,H as v,Ja as V,Ka as z,L as C,M as h,Ma as H,V as k,W as O,Wa as F,Xa as E,_ as i,a as L,aa as b,ab as N,b as A,ea as p,fa as D,ga as l,gb as R,ha as o,ia as r,ic as J,ja as d,jb as M,ma as I,pa as T,qa as c,ta as P,ua as x,xa as m,ya as g,za as _}from"./chunk-PDSTOEGJ.js";var Z=[""];function tt(s,e){if(s&1){let t=I();o(0,"span",14),T("click",function(){C(t);let a=c(2).index,f=c();return h(f.scrollToNext(f.data,a))}),m(1,"next"),r()}}function et(s,e){if(s&1){let t=I();o(0,"span",15),T("click",function(){C(t),c();let a=D(1);return h(a.expanded=!a.expanded)}),m(1," [ - ] "),r()}}function nt(s,e){if(s&1){let t=I();o(0,"span",16),T("click",function(){C(t),c();let a=D(1);return h(a.expanded=!a.expanded)}),m(1,"[ + ]"),r()}}function it(s,e){if(s&1&&(o(0,"div",17),d(1,"app-comments",18),r()),s&2){let t=c(2).$implicit;i(1),l("data",t.kidsData)}}function at(s,e){if(s&1&&(o(0,"mat-expansion-panel",4,5)(2,"mat-expansion-panel-header")(3,"mat-panel-title")(4,"span",6)(5,"a",7),m(6),r(),o(7,"a"),m(8),r(),p(9,tt,2,0,"span",8),o(10,"span"),p(11,et,2,0,"span",9),p(12,nt,2,0,"span",10),r()()()(),o(13,"div",11),d(14,"div",12),r(),p(15,it,2,1,"div",13),r()),s&2){let t=D(1),n=c(),a=n.$implicit,f=n.last,X=c();i(4),l("id",a.id),i(1),x("routerLink","/user/",a.by,""),i(1),g((a==null?null:a.by)+" "),i(2),_("",X.getTime(a==null?null:a.time)," | "),i(1),l("ngIf",!f),i(2),l("ngIf",t.expanded==!0),i(1),l("ngIf",t.expanded==!1),i(2),l("innerHTML",a==null?null:a.text,k),i(1),l("ngIf",a==null?null:a.kidsData)}}function ot(s,e){if(s&1&&(o(0,"mat-accordion",2),p(1,at,16,9,"mat-expansion-panel",3),r()),s&2){let t=e.$implicit;i(1),l("ngIf",!t.deleted)}}function rt(s,e){s&1&&(o(0,"div"),d(1,"div",19)(2,"div",19),o(3,"div"),d(4,"div",19)(5,"div",19),r(),o(6,"div"),d(7,"div",19)(8,"div",19),r()())}var u=class{constructor(){this.data=[]}ngOnInit(){this.sortCommentsOnTime()}scrollToNext(e,t){if(e[t+1]){var n=document.getElementById(e[t+1].id);n?.scrollIntoView({behavior:"smooth",block:"start"})}else console.log("parent scroll trig"),this.scrollToParentNext(e[t].parent);console.log(e)}scrollToParentNext(e){console.log(e)}sortCommentsOnTime(){this.data.sort(({time:e},{time:t})=>e>t?1:e<t?-1:0)}getTime(e){return new Date(e*1e3).toLocaleDateString()}},w=u;(()=>{u.\u0275fac=function(t){return new(t||u)}})(),(()=>{u.\u0275cmp=v({type:u,selectors:[["app-comments"]],viewQuery:function(t,n){if(t&1&&z(Z,5),t&2){let a;V(a=H())&&(n.span=a.first)}},inputs:{data:"data"},standalone:!0,features:[S],decls:2,vars:2,consts:[["accordion","",4,"ngFor","ngForOf"],[4,"ngIf"],["accordion",""],["hideToggle","","expanded","true","disabled","true","class","comment",4,"ngIf"],["hideToggle","","expanded","true","disabled","true",1,"comment"],["mep","matExpansionPanel"],[1,"comment-info",3,"id"],[3,"routerLink"],["class","next","matTooltip","Go to next",3,"click",4,"ngIf"],["class","minimize","matTooltip","minimize",3,"click",4,"ngIf"],["class","minimize","matTooltip","expand",3,"click",4,"ngIf"],[1,"comment-body"],[1,"comment-text",3,"innerHTML"],["class","sub-comments",4,"ngIf"],["matTooltip","Go to next",1,"next",3,"click"],["matTooltip","minimize",1,"minimize",3,"click"],["matTooltip","expand",1,"minimize",3,"click"],[1,"sub-comments"],[3,"data"],[1,"skeleton","skeleton-text"]],template:function(t,n){t&1&&(p(0,ot,2,1,"mat-accordion",0),p(1,rt,9,0,"div",1)),t&2&&(l("ngForOf",n.data),i(1),l("ngIf",n.data.length==0))},dependencies:[u,N,F,E,U,q,Q,G,$,M],styles:[".comment-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:start;align-items:center;gap:4px}@media screen and (max-width: 900px){.sub-comments[_ngcontent-%COMP%]{margin-left:5px}}.sub-comments[_ngcontent-%COMP%]{margin-left:12px}"]})})();function st(s,e){if(s&1&&d(0,"div",9),s&2){let t=c();l("innerHTML",t.storyData.text,k)}}var y=class{constructor(e,t){this.activatedRoute=e,this.apiService=t,this.storyId="",this.storyData=[],this.kidsArray=[],this.kidsArrayData=[]}ngOnInit(){this.storyId=this.activatedRoute.snapshot.params.id,this.getStoryData()}getStoryData(){this.apiService.getStoryById(this.storyId).subscribe(e=>{this.storyData=e,this.getKidsData()})}getKidsData(){this.kidsArray=this.storyData.kids,this.kidsArray.forEach(e=>{this.apiService.getCommentById(e).subscribe(t=>{var n=this.getSubKids(t);this.kidsArrayData.push(n)})}),console.log(this.kidsArrayData)}getTime(e){return new Date(e*1e3).toLocaleDateString()}getSubKids(e){if(e.kids){let t=[];return e.kids.forEach(n=>{this.apiService.getCommentById(n).subscribe(a=>{var f=this.getSubKids(a);t.push(f)})}),A(L({},e),{kidsData:t})}else return e}},W=y;(()=>{y.\u0275fac=function(t){return new(t||y)(b(R),b(J))}})(),(()=>{y.\u0275cmp=v({type:y,selectors:[["app-story"]],standalone:!0,features:[S],decls:19,vars:11,consts:[[1,"page"],[1,"story"],[1,"story-title"],[3,"innerHTML",4,"ngIf"],["target","_blank",1,"story-url",3,"href"],[1,"story-info"],[3,"routerLink"],["fxLayout","column nowrap","fxLayoutAlign","start stretch","fxLayoutGap","15px",2,"margin-top","10px"],[3,"data"],[3,"innerHTML"]],template:function(t,n){t&1&&(d(0,"app-heading"),o(1,"div",0)(2,"mat-card",1)(3,"span",2),m(4),r(),p(5,st,1,1,"div",3),o(6,"a",4),m(7),r(),o(8,"div",5),m(9),o(10,"a",6),m(11),r(),o(12,"a"),m(13),r(),m(14," | "),o(15,"a",6),m(16),r()()(),o(17,"div",7),d(18,"app-comments",8),r()()),t&2&&(i(4),g(n.storyData==null?null:n.storyData.title),i(1),l("ngIf",n.storyData==null?null:n.storyData.text),i(1),P("href",n.storyData==null?null:n.storyData.url,O),i(1),g(n.storyData==null?null:n.storyData.url),i(2),_("",n.storyData.score," points by "),i(1),x("routerLink","/user/",n.storyData==null?null:n.storyData.by,""),i(1),_("",n.storyData==null?null:n.storyData.by," "),i(2),_(" ",n.getTime(n.storyData.time)," "),i(2),x("routerLink","/story/",n.storyData.id,""),i(1),_(" ",n.storyData==null?null:n.storyData.descendants," comments "),i(2),l("data",n.kidsArrayData))},dependencies:[j,M,B,K,E,w],styles:[".textarea[_ngcontent-%COMP%]{resize:none}"]})})();export{W as StoryComponent};
